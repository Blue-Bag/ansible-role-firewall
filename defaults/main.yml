---
# firewall mode [simple | chain ]
firewall_mode: simple

# =======================   simple config
firewall_allowed_tcp_ports:
  - "22"
  - "25"
  - "80"
  - "443"

# allow mail port out
firewall_allowed_tcp_ports_out:
  - "25"



firewall_allowed_udp_ports: []
firewall_forwarded_tcp_ports: []
firewall_forwarded_udp_ports: []
firewall_additional_rules: []


# =======================   chain config
firewall_whitelist:
  - { name: 'local', ip: "192.168.100.1" }

#firewall_whitelistgroup: []


firewall_blacklist:
  - { name: 'Some rogue', ip: "96.47.225.0/24" }

firewall_protected_chains:
  - {
      port: "22",
      name: "SSH",
      default: "DROP",
      ratelimit: "True",
      hit_rate: 4,
      hit_ttl: 60

     }
  - {
      port: "10000",
      name: "WEBMIN",
      default: "DROP"
     }
  - {
      port: "80",
      name: "HTTP",
      default: "ACCEPT"
     }
  - {
      port: "443",
      name: "HTTPS",
      default: "ACCEPT"
     }
  - {
      port: "3306",
      name: "MYSQL",
      default: "DROP"
     }
  - {
      port: "2812",
      name: "MONIT",
      default: "DROP"
     }

# ========================  extended rules
firewall_extra_security: true
firewall_block_portscan: true
firewall_block_spoofed: true
firewall_block_smurf: true
firewall_allow_ping: true

# ========================  ipset
firewall_ipset: False
#Create lists, for network blocks and single IP addresses
#hash:net = Networks
#hash:ip = single IPs
firewall_blocklists:
  - {
      name: blocked-nets,
      type: 'hash:net',
      src: 'blocked-nets.txt'
  }
  - {
      name: blocked-ips,
      type: 'hash:ip',
      src: 'blocked-ips.txt'
  }

# ======================= repo for Redhat ipset
# Pass in a comma-separated list of repos to use (e.g. "remi,epel").
php_enablerepo: "epel"

# =======================  Badips
# badips_key: ''
firewall_block_badips: False
# level to report 0 = all - used as we want all of ours
firewall_badips_level: '0'
# service to report on - we want all of ours
firewall_badips_service: 'any'
firewall_badips_ipset: 'badips'
firewall_badips_folder: '/usr/share/badips'
firewall_badips_db: '/usr/share/badips/badips.db'

